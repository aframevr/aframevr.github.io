








<!DOCTYPE html>
<html lang="en" data-is-home="false" data-is-mobile="false" data-supports-vr="false" data-supports-touch="false" data-root-url="/" data-title="{title} | A-Frame" data-is-spa="" data-ga-id="UA-24056643-4">
  <head>
    <title>Building an Advanced Scene —  Docs - A-Frame</title>
    

<script>
var host = window.location.protocol + '//' + window.location.hostname;
if (host === 'http://aframe.io' || host === 'http://aframevr.github.io') {
  window.location.href = 'https:' + window.location.href.substring(6);
}
</script>


    <meta charset="utf-8">
    <meta name="robots" content="all">
    <meta name="description" content="A-Frame – Building Blocks for the VR Web">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta property="fb:app_id" content="1535794316743373">
    <meta property="og:title" content="A-Frame">
    <meta property="og:site_name" content="A-Frame">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aframe.io/">
    <meta property="og:description" content="Building Blocks for the VR Web">
    <meta property="og:image" content="http://aframe.io/images/card.png">
    <meta property="og:image:secure_url" content="https://aframe.io/images/card.png">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@aframevr">
    <meta name="twitter:creator" content="@aframevr">
    <meta name="twitter:title" content="A-Frame">
    <meta name="twitter:description" content="Building Blocks for the VR Web">
    <meta name="twitter:image" content="https://aframe.io/images/card.png">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="black">
    <link rel="icon" sizes="192x192" href="/images/aframe-logo-192.png">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/images/aframe-logo-152.png">

    <link rel="alternate" type="application/rss+xml" title="Feed" href="/feed.xml">

    <script src="/js/compat.js"></script>

    
      <link rel="stylesheet" href="/css/secondary.css">
    

    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-24056643-4', 'auto');
  ga('send', 'pageview');
</script>


  </head>
  <body data-page-layout="docs" data-page-type="guide">
    
      <aside class="sidebar sidebar-mobile borderless-links c">
  <header id="header" class="header">
    <a href="#secondary-nav" class="mobile-nav-btn">Menu</a>
    <a id="logo" class="logo" href="/">
      <span class="logo__wordmark">A-Frame</span>
    </a>
  </header>
</aside>

    
    <main id="main" class="main">
      <aside class="sidebar borderless-links">

  

<div id="secondary-nav" class="secondary-nav">
  <header id="header" class="header">
    <a id="logo" class="logo" href="/">
      <span class="logo__wordmark">A-Frame</span>
    </a>
  </header>

  <ul id="nav" class="nav">
    
      <li
        
        class="nav-item"><a href="/docs/guide/" class="nav-link nav-link-docs current"><span>Guide</span></a></li>
    
      <li
        
        class="nav-item"><a href="/docs/guide/getting-started.html" class="nav-link nav-link-docs"><span>Install</span></a></li>
    
      <li
        
        class="nav-item"><a href="/examples/" class="nav-link nav-link-docs"><span>Examples</span></a></li>
    
      <li
        
        class="nav-item"><a href="/faq/" class="nav-link nav-link-docs"><span>FAQ</span></a></li>
    
      <li
        
        class="nav-item"><a href="/blog/" class="nav-link nav-link-docs"><span>Blog</span></a></li>
    
      <li
        
        class="nav-item"><a href="/community/" class="nav-link nav-link-docs"><span>Community</span></a></li>
    
      <li
         data-slug="github"
        class="nav-item"><a href="https://github.com/aframevr/aframe/" class="nav-link nav-link-docs" rel="external" title="A-Frame project repository on GitHub"><span>GitHub</span></a></li>
    
      <li
         data-slug="slug"
        class="nav-item"><a href="https://aframevr-slack.herokuapp.com" class="nav-link nav-link-docs" rel="external" title="A-Frame Slack (sign up)"><span>Slack</span></a></li>
    
  </ul>
</div>


  <div class="list">
    
    
      
      <h3 class="section-title docs-section-title section-title-active"><a href="/docs/guide/" class="section-title-link section-title-link-active">Guide</a></h3>

      <ol class="subnav section-subnav numbered-subnav">
        
          <li class="subnav-item ">
            <a href="/docs/guide/" class="subnav-link">Overview</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/guide/getting-started.html" class="subnav-link">Getting Started</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/guide/building-a-basic-scene.html" class="subnav-link">Building a Basic Scene</a>
          </li>
        
          <li class="subnav-item  subnav-item-current">
            <a href="/docs/guide/building-an-advanced-scene.html" class="subnav-link current">Building an Advanced Scene</a>
          </li>
        
      </ol>
    
      
      <h3 class="section-title docs-section-title section-title-inactive"><a href="/docs/core/" class="section-title-link section-title-link-inactive">Core</a></h3>

      <ol class="subnav section-subnav">
        
          <li class="subnav-item ">
            <a href="/docs/core/" class="subnav-link">Entity-Component-System</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/entity.html" class="subnav-link">Entity</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/component.html" class="subnav-link">Component</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/systems.html" class="subnav-link">System</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/scene.html" class="subnav-link">Scene</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/animations.html" class="subnav-link">Animations</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/mixins.html" class="subnav-link">Mixins</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/shaders.html" class="subnav-link">Shaders</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/asset-management-system.html" class="subnav-link">Asset Management System</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/core/AFRAME.html" class="subnav-link">AFRAME</a>
          </li>
        
      </ol>
    
      
      <h3 class="section-title docs-section-title section-title-inactive"><a href="/docs/components/" class="section-title-link section-title-link-inactive">Components</a></h3>

      <ol class="subnav section-subnav">
        
          <li class="subnav-item ">
            <a href="/docs/components/" class="subnav-link">camera</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/canvas.html" class="subnav-link">canvas</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/collada-model.html" class="subnav-link">collada-model</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/cursor.html" class="subnav-link">cursor</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/fog.html" class="subnav-link">fog</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/geometry.html" class="subnav-link">geometry</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/keyboard-shortcuts.html" class="subnav-link">keyboard-shortcuts</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/light.html" class="subnav-link">light</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/look-at.html" class="subnav-link">look-at</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/look-controls.html" class="subnav-link">look-controls</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/material.html" class="subnav-link">material</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/obj-model.html" class="subnav-link">obj-model</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/position.html" class="subnav-link">position</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/raycaster.html" class="subnav-link">raycaster</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/rotation.html" class="subnav-link">rotation</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/scale.html" class="subnav-link">scale</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/sound.html" class="subnav-link">sound</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/stats.html" class="subnav-link">stats</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/visible.html" class="subnav-link">visible</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/vr-mode-ui.html" class="subnav-link">vr-mode-ui</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/components/wasd-controls.html" class="subnav-link">wasd-controls</a>
          </li>
        
      </ol>
    
      
      <h3 class="section-title docs-section-title section-title-inactive"><a href="/docs/primitives/" class="section-title-link section-title-link-inactive">Primitives</a></h3>

      <ol class="subnav section-subnav">
        
          <li class="subnav-item ">
            <a href="/docs/primitives/" class="subnav-link">Introduction</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/mesh-attributes.html" class="subnav-link">Mesh Attributes</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-box.html" class="subnav-link">&lt;a-box&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-camera.html" class="subnav-link">&lt;a-camera&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-collada-model.html" class="subnav-link">&lt;a-collada-model&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-cone.html" class="subnav-link">&lt;a-cone&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-cursor.html" class="subnav-link">&lt;a-cursor&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-curvedimage.html" class="subnav-link">&lt;a-curvedimage&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-cylinder.html" class="subnav-link">&lt;a-cylinder&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-image.html" class="subnav-link">&lt;a-image&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-light.html" class="subnav-link">&lt;a-light&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-obj-model.html" class="subnav-link">&lt;a-obj-model&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-plane.html" class="subnav-link">&lt;a-plane&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-ring.html" class="subnav-link">&lt;a-ring&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-sky.html" class="subnav-link">&lt;a-sky&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-sphere.html" class="subnav-link">&lt;a-sphere&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-torus.html" class="subnav-link">&lt;a-torus&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-video.html" class="subnav-link">&lt;a-video&gt;</a>
          </li>
        
          <li class="subnav-item ">
            <a href="/docs/primitives/a-videosphere.html" class="subnav-link">&lt;a-videosphere&gt;</a>
          </li>
        
      </ol>
    
  </div>

</aside>

<div class="content content--structured content--guide copy">
  <div class="copy__wrap">

    <p class="page__section"><a href="/docs/guide/" class="borderless-link">Guide</a></p>
    <h1 class="page__title">Building an Advanced Scene</h1>

    <script async src="//assets.codepen.io/assets/embed/ei.js"></script>

<blockquote>
<p>Play with the <a href="http://codepen.io/team/mozvr/pen/PNoWEz/?editors=1000" target="_blank" rel="external">finished example on CodePen</a>.</p>
</blockquote>
<p>We built a <a href="./building-a-basic-scene.html">basic scene</a>, but how can we do more? A-Frame is just an abstraction on top of <a href="http://threejs.org" target="_blank" rel="external">three.js</a>, and with <a href="../core/component.html">A-Frame components</a> (not to be confused with <a href="http://webcomponents.org/" target="_blank" rel="external">Web Components</a>), we can do just about anything three.js can, which is a lot. Let’s go through an example building a scene where the workflow revolves around writing components. We’ll build an interactive scene in which we fire lasers at enemies surrounding us. We can use the standard components that ship with A-Frame, or use components that A-Frame developers have published to the ecosystem. Better yet, we can write our own components to do whatever we want!</p>
<p>Let’s start by adding an enemy target:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="wGBLeB" data-default-tab="html" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/wGBLeB/" target="_blank" rel="external">Laser Shooter - Step 1</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>

<p>This creates a basic static scene where the enemy stares at you even as you move around. We can use A-Frame components from the ecosystem to do some neat things.</p>
<h2 id="Using-Components"><a href="#Using-Components" class="headerlink" title="Using Components"></a>Using Components</h2><p>The <a href="https://github.com/aframevr/awesome-aframe#components" target="_blank" rel="external">awesome-aframe repository</a> is a great place to find components that the community has created to enable new features. Many of these components are started from the <a href="https://github.com/ngokevin/aframe-component-boilerplate" target="_blank" rel="external">Component Boilerplate</a> and should provide builds in the <code>dist/</code> folders in their repositories. Take the <a href="https://github.com/ngokevin/aframe-layout-component" target="_blank" rel="external">layout component</a> for example. We can grab the build, drop it into our scene, and immediately be able to use a 3D layout system to automatically position entities. Instead of having one enemy, let’s have ten enemies positioned in a circle around the player:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="bpNPjp" data-default-tab="html" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/bpNPjp/" target="_blank" rel="external">Laser Shooter - Step 2</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>

<p>It is messy in markup to have the enemy entity duplicated ten times. We can drop in the <a href="https://github.com/ngokevin/aframe-template-component" target="_blank" rel="external">template component</a> to clean that up. We can also use the <a href="../core/animation.html">animation system</a> to have enemies march in a circle around us:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="JXoQBm" data-default-tab="html" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/JXoQBm/" target="_blank" rel="external">Laser Shooter - Step 3</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>

<p>By mixing and matching the layout and template components, we now have ten enemies surrounding us in a circle. Let’s enable gameplay by writing our own components.</p>
<h2 id="Writing-Components"><a href="#Writing-Components" class="headerlink" title="Writing Components"></a>Writing Components</h2><p>Developers that are comfortable with JavaScript and three.js can write components to add appearance, behavior, and functionality to the experience. As we’ve seen these components can then be reused and shared with the community. Though not all components have to be shared; they can be ad-hoc or one-off. Since A-Frame is based on an <a href="../core/">entity-component-system pattern</a>, most logic should be implemented within components. The development workflow within A-Frame should try to revolve around components. The <a href="../core/component.html">component documentation</a> goes into much more detail on what a component looks like and how to write one.</p>
<p>We want to be able to fire lasers at the enemies and have them disappear. We will need a component to create lasers on click, a component to generate clicks, a component to propel those lasers, a component to check when a laser comes in contact with an enemy.</p>
<h3 id="spawner-Component"><a href="#spawner-Component" class="headerlink" title="spawner Component"></a>spawner Component</h3><p>Let’s start by being able to create lasers. We want to be able to spawn a laser entity that starts at the player’s current position. We’ll create a spawner component that listens to an event on the entity, and when that event is emitted, we’ll spawn an entity with a predefined <a href="../core/mixins.html">mixin</a> of components:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">AFRAME.registerComponent(<span class="string">'spawner'</span>, &#123;</span><br><span class="line">  schema: &#123;</span><br><span class="line">    on: &#123; <span class="keyword">default</span>: <span class="string">'click'</span> &#125;,</span><br><span class="line">    mixin: &#123; <span class="keyword">default</span>: <span class="string">''</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * Add event listener.</span><br><span class="line">   */</span></span><br><span class="line">  update: <span class="function"><span class="keyword">function</span> (<span class="params">oldData</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.el.addEventListener(<span class="keyword">this</span>.data.on, <span class="keyword">this</span>.spawn.bind(<span class="keyword">this</span>));</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * Spawn new entity at entity's current position.</span><br><span class="line">   */</span></span><br><span class="line">  spawn: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="keyword">this</span>.el;</span><br><span class="line">    <span class="keyword">var</span> entity = <span class="built_in">document</span>.createElement(<span class="string">'a-entity'</span>);</span><br><span class="line">    <span class="keyword">var</span> matrixWorld = el.object3D.matrixWorld;</span><br><span class="line">    <span class="keyword">var</span> position = <span class="keyword">new</span> THREE.Vector3();</span><br><span class="line">    <span class="keyword">var</span> rotation = el.getAttribute(<span class="string">'rotation'</span>);</span><br><span class="line">    <span class="keyword">var</span> entityRotation;</span><br><span class="line"></span><br><span class="line">    position.setFromMatrixPosition(matrixWorld);</span><br><span class="line">    entity.setAttribute(<span class="string">'position'</span>, position);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Have the spawned entity face the same direction as the entity.</span></span><br><span class="line">    <span class="comment">// Allow the entity to further modify the inherited rotation.</span></span><br><span class="line">    position.setFromMatrixPosition(matrixWorld);</span><br><span class="line">    entity.setAttribute(<span class="string">'position'</span>, position);</span><br><span class="line">    entity.setAttribute(<span class="string">'mixin'</span>, <span class="keyword">this</span>.data.mixin);</span><br><span class="line">    entity.addEventListener(<span class="string">'loaded'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      entityRotation = entity.getComputedAttribute(<span class="string">'rotation'</span>);</span><br><span class="line">      entity.setAttribute(<span class="string">'rotation'</span>, &#123;</span><br><span class="line">        x: entityRotation.x + rotation.x,</span><br><span class="line">        y: entityRotation.y + rotation.y,</span><br><span class="line">        z: entityRotation.z + rotation.z</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    el.sceneEl.appendChild(entity);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="click-listener-Component"><a href="#click-listener-Component" class="headerlink" title="click-listener Component"></a>click-listener Component</h3><p>Now we need to a way to generate a click event on the player entity in order to spawn the laser. We could just write a vanilla JavaScript event handler in a content script, but it is more reusable to write a component that can allow any entity to listen for clicks:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">AFRAME.registerComponent(<span class="string">'click-listener'</span>, &#123;</span><br><span class="line">  init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="keyword">this</span>.el;</span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      el.emit(<span class="string">'click'</span>, <span class="literal">null</span>, <span class="literal">false</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>From HTML, we define the laser mixin and attach the spawner and click-listener components to the player. When we click, the spawner component will generate a laser starting in front of the camera:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="jqEjvB" data-default-tab="html" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/jqEjvB/" target="_blank" rel="external">Laser Shooter - Step 4</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>

<h3 id="projectile-Component"><a href="#projectile-Component" class="headerlink" title="projectile Component"></a>projectile Component</h3><p>Now lasers will spawn in front of us when we click, but we need them to fire and travel. In the spawner component, we had the laser point in the rotation of the camera, and we rotated it 90-degrees around the X-axis to align it correctly. We can add a projectile component to have the laser travel straight in the direction it’s already facing (its local Y-axis in this case):</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">AFRAME.registerComponent(<span class="string">'projectile'</span>, &#123;</span><br><span class="line">  schema: &#123;</span><br><span class="line">    speed: &#123; <span class="keyword">default</span>: <span class="number">-0.4</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  tick: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.el.object3D.translateY(<span class="keyword">this</span>.data.speed);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Then attach the projectile component to the laser mixin:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a-assets</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Attach projectile behavior. --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a-mixin</span> <span class="attr">id</span>=<span class="string">"laser"</span> <span class="attr">geometry</span>=<span class="string">"primitive: cylinder; radius: 0.05; translate: 0 -2 0"</span></span><br><span class="line">                      <span class="attr">material</span>=<span class="string">"color: green; metalness: 0.2; opacity: 0.4; roughness: 0.3"</span></span><br><span class="line">                      <span class="attr">projectile</span>=<span class="string">"speed: -0.5"</span>&gt;</span><span class="tag">&lt;/<span class="name">a-mixin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a-assets</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The laser will now fire like a projectile on click:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="YqPmzK" data-default-tab="result" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/YqPmzK/" target="_blank" rel="external">Laser Shooter - Step 5</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>

<h3 id="collider-Component"><a href="#collider-Component" class="headerlink" title="collider Component"></a>collider Component</h3><p>The last step is to add a collider component so we can detect when the laser hits an entity. We can do this using the <a href="http://threejs.org/docs/index.html#Reference/Core/Raycaster" target="_blank" rel="external">three.js Raycaster</a>, drawing a ray (line) from one end of the laser to the other, then continuously checking if one of the enemies are intersecting the ray. If an enemy is intersecting our ray, then it is touching the laser, and we use an event to tell the enemy that it got hit:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">AFRAME.registerComponent(<span class="string">'collider'</span>, &#123;</span><br><span class="line">  schema: &#123;</span><br><span class="line">    target: &#123; <span class="keyword">default</span>: <span class="string">''</span> &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * Calculate targets.</span><br><span class="line">   */</span></span><br><span class="line">  init: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> targetEls = <span class="keyword">this</span>.el.sceneEl.querySelectorAll(<span class="keyword">this</span>.data.target);</span><br><span class="line">    <span class="keyword">this</span>.targets = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; targetEls.length; i++) &#123;</span><br><span class="line">      <span class="keyword">this</span>.targets.push(targetEls[i].object3D);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.el.object3D.updateMatrixWorld();</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span><br><span class="line">   * Check for collisions (for cylinder).</span><br><span class="line">   */</span></span><br><span class="line">  tick: <span class="function"><span class="keyword">function</span> (<span class="params">t</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> collisionResults;</span><br><span class="line">    <span class="keyword">var</span> directionVector;</span><br><span class="line">    <span class="keyword">var</span> el = <span class="keyword">this</span>.el;</span><br><span class="line">    <span class="keyword">var</span> mesh = el.getObject3D(<span class="string">'mesh'</span>);</span><br><span class="line">    <span class="keyword">var</span> object3D = el.object3D;</span><br><span class="line">    <span class="keyword">var</span> raycaster;</span><br><span class="line">    <span class="keyword">var</span> vertices = mesh.geometry.vertices;</span><br><span class="line">    <span class="keyword">var</span> bottomVertex = vertices[<span class="number">0</span>].clone();</span><br><span class="line">    <span class="keyword">var</span> topVertex = vertices[vertices.length - <span class="number">1</span>].clone();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate absolute positions of start and end of entity.</span></span><br><span class="line">    bottomVertex.applyMatrix4(object3D.matrixWorld);</span><br><span class="line">    topVertex.applyMatrix4(object3D.matrixWorld);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Direction vector from start to end of entity.</span></span><br><span class="line">    directionVector = topVertex.clone().sub(bottomVertex).normalize();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Raycast for collision.</span></span><br><span class="line">    raycaster = <span class="keyword">new</span> THREE.Raycaster(bottomVertex, directionVector, <span class="number">1</span>);</span><br><span class="line">    collisionResults = raycaster.intersectObjects(<span class="keyword">this</span>.targets, <span class="literal">true</span>);</span><br><span class="line">    collisionResults.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">target</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// Tell collided entity about the collision.</span></span><br><span class="line">      target.object.el.emit(<span class="string">'collider-hit'</span>, &#123;target: el&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>Then we attach a class to the enemies to designate them as targets, attach animations that trigger on collision to make them disappear, and finally attach the collider component to the laser that targets enemies:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a-assets</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">"enemy-sprite"</span> <span class="attr">src</span>=<span class="string">"img/enemy.png"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"enemies"</span> <span class="attr">type</span>=<span class="string">"text/x-nunjucks-template"</span>&gt;</span><span class="xml"></span><br><span class="line">    <span class="tag">&lt;<span class="name">a-entity</span> <span class="attr">layout</span>=<span class="string">"type: circle; radius: 5"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a-animation</span> <span class="attr">attribute</span>=<span class="string">"rotation"</span> <span class="attr">dur</span>=<span class="string">"8000"</span> <span class="attr">easing</span>=<span class="string">"linear"</span> <span class="attr">repeat</span>=<span class="string">"indefinite"</span> <span class="attr">to</span>=<span class="string">"0 360 0"</span>&gt;</span><span class="tag">&lt;/<span class="name">a-animation</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      &#123;% for x in range(num) %&#125;</span><br><span class="line">        <span class="comment">&lt;!-- Attach enemy class. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a-image</span> <span class="attr">class</span>=<span class="string">"enemy"</span> <span class="attr">look-at</span>=<span class="string">"#player"</span> <span class="attr">src</span>=<span class="string">"#enemy-sprite"</span> <span class="attr">transparent</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- Attach collision handler animations. --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-animation</span> <span class="attr">attribute</span>=<span class="string">"opacity"</span> <span class="attr">begin</span>=<span class="string">"collider-hit"</span> <span class="attr">dur</span>=<span class="string">"400"</span> <span class="attr">ease</span>=<span class="string">"linear"</span></span><br><span class="line">                       <span class="attr">from</span>=<span class="string">"1"</span> <span class="attr">to</span>=<span class="string">"0"</span>&gt;</span><span class="tag">&lt;/<span class="name">a-animation</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">a-animation</span> <span class="attr">attribute</span>=<span class="string">"scale"</span> <span class="attr">begin</span>=<span class="string">"collider-hit"</span> <span class="attr">dur</span>=<span class="string">"400"</span> <span class="attr">ease</span>=<span class="string">"linear"</span></span><br><span class="line">                       <span class="attr">to</span>=<span class="string">"0 0 0"</span>&gt;</span><span class="tag">&lt;/<span class="name">a-animation</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">a-image</span>&gt;</span></span><br><span class="line">      &#123;% endfor %&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">a-entity</span>&gt;</span></span><br><span class="line">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Attach collider that targets enemies. --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a-mixin</span> <span class="attr">id</span>=<span class="string">"laser"</span> <span class="attr">geometry</span>=<span class="string">"primitive: cylinder; radius: 0.05; translate: 0 -2 0"</span></span><br><span class="line">                      <span class="attr">material</span>=<span class="string">"color: green; metalness: 0.2; opacity: 0.4; roughness: 0.3"</span></span><br><span class="line">                      <span class="attr">projectile</span>=<span class="string">"speed: -0.5"</span> <span class="attr">collider</span>=<span class="string">"target: .enemy"</span>&gt;</span><span class="tag">&lt;/<span class="name">a-mixin</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a-assets</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>And there we have a complete basic interactive scene in A-Frame that can be viewed in VR. We package power into components that allow us to declaratively build scenes without losing control or flexibility. The result is a rudimentary FPS game that supports VR in ultimately <strong>just 30 lines of HTML</strong>:</p>
<p data-height="500" data-theme-id="0" data-slug-hash="reaXNr" data-default-tab="result" data-user="mozvr" class="codepen">See the Pen <a href="http://codepen.io/team/mozvr/pen/reaXNr/" target="_blank" rel="external">Laser Shooter - Final</a> by MozVR (<a href="http://codepen.io/team/mozvr" target="_blank" rel="external">@mozvr</a>) on <a href="http://codepen.io" target="_blank" rel="external">CodePen</a>.</p>



    <footer class="footer guide-links c">
      
        <span class="float-left"><a href="/docs/guide/building-a-basic-scene.html" class="guide-link guide-link-left">← Building a Basic Scene</a></span>
      
      
    </footer>

    <footer class="footer footnote">
  <p>Caught a mistake or want to contribute to the documentation? <br><br> <a href="https://github.com/aframevr/aframe/edit/master/docs/guide/building-an-advanced-scene.md" class="github-file-link" target="_blank" rel="external">Suggest an edit to this page on GitHub</a></p>
</footer>

  </div>
</div>

    </main>
    <script src="/js/common.js"></script>
    <script src="/js/ga.js"></script>
    <script src="/js/single-page.js"></script>
    
    
      <script src="/js/docs.js"></script>
    
  </body>
</html>
